apiVersion: template.openshift.io/v1
kind: Template
metadata:
  name: koku
objects:
- apiVersion: cloud.redhat.com/v1alpha1
  kind: ClowdApp
  metadata:
    name: koku
  spec:
    database:
      dbResourceSize: small
      name: ${DATABASE_NAME}
      version: ${{DATABASE_VERSION}}
    dependencies:
    - ingress
    - rbac
    - sources-api
    deployments:
    - name: api-reads
      podSpec:
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: DJANGO_SECRET_KEY
          valueFrom:
            secretKeyRef:
              key: django-secret-key
              name: koku-secret
              optional: false
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: API_PATH_PREFIX
          value: ${API_PATH_PREFIX}
        - name: APP_DOMAIN
          value: ${APP_DOMAIN}
        - name: MAX_GROUP_BY_OVERRIDE
          value: ${MAX_GROUP_BY_OVERRIDE}
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: GUNICORN_LOG_LEVEL
          value: ${GUNICORN_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: DJANGO_LOG_LEVEL
          value: ${DJANGO_LOG_LEVEL}
        - name: DJANGO_LOG_FORMATTER
          value: ${DJANGO_LOG_FORMATTER}
        - name: DJANGO_LOG_HANDLERS
          value: ${DJANGO_LOG_HANDLERS}
        - name: DJANGO_LOG_DIRECTORY
          value: ${DJANGO_LOG_DIRECTORY}
        - name: DJANGO_LOGGING_FILE
          value: ${DJANGO_LOG_FILE}
        - name: RBAC_SERVICE_PATH
          value: ${RBAC_SERVICE_PATH}
        - name: RBAC_CACHE_TTL
          value: ${RBAC_CACHE_TTL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: POD_CPU_LIMIT
          valueFrom:
            resourceFieldRef:
              containerName: koku-api-reads
              resource: limits.cpu
        - name: GUNICORN_WORKERS
          value: ${GUNICORN_WORKERS}
        - name: GUNICORN_THREADS
          value: ${GUNICORN_THREADS}
        - name: ACCOUNT_ENHANCED_METRICS
          value: ${ACCOUNT_ENHANCED_METRICS}
        - name: CACHED_VIEWS_DISABLED
          value: ${CACHED_VIEWS_DISABLED}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: NOTIFICATION_CHECK_TIME
          value: ${NOTIFICATION_CHECK_TIME}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        - name: RBAC_CACHE_TIMEOUT
          value: ${RBAC_CACHE_TIMEOUT}
        - name: CACHE_TIMEOUT
          value: ${CACHE_TIMEOUT}
        - name: TAG_ENABLED_LIMIT
          value: ${TAG_ENABLED_LIMIT}
        - name: USE_READREPLICA
          value: ${USE_READREPLICA}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: ${API_PATH_PREFIX}/v1/status/
            port: web
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: ${API_PATH_PREFIX}/v1/status/
            port: web
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_KOKU_READS}
            memory: ${MEMORY_LIMIT_KOKU_READS}
          requests:
            cpu: ${CPU_REQUEST_KOKU_READS}
            memory: ${MEMORY_REQUEST_KOKU_READS}
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        - mountPath: /etc/db/readreplica
          name: koku-read-only-db
          readOnly: true
        volumes:
        - emptyDir: {}
          name: tmp-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
        - name: koku-read-only-db
          secret:
            items:
            - key: db.host
              path: db_host
            - key: db.name
              path: db_name
            - key: db.password
              path: db_password
            - key: db.port
              path: db_port
            - key: db.user
              path: db_user
            optional: true
            secretName: ${KOKU_READ_ONLY_DB}
      replicas: ${{KOKU_READS_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: true
    - name: api-writes
      podSpec:
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: DJANGO_SECRET_KEY
          valueFrom:
            secretKeyRef:
              key: django-secret-key
              name: koku-secret
              optional: false
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: API_PATH_PREFIX
          value: ${API_PATH_PREFIX}
        - name: APP_DOMAIN
          value: ${APP_DOMAIN}
        - name: MAX_GROUP_BY_OVERRIDE
          value: ${MAX_GROUP_BY_OVERRIDE}
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: GUNICORN_LOG_LEVEL
          value: ${GUNICORN_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: DJANGO_LOG_LEVEL
          value: ${DJANGO_LOG_LEVEL}
        - name: DJANGO_LOG_FORMATTER
          value: ${DJANGO_LOG_FORMATTER}
        - name: DJANGO_LOG_HANDLERS
          value: ${DJANGO_LOG_HANDLERS}
        - name: DJANGO_LOG_DIRECTORY
          value: ${DJANGO_LOG_DIRECTORY}
        - name: DJANGO_LOGGING_FILE
          value: ${DJANGO_LOG_FILE}
        - name: RBAC_SERVICE_PATH
          value: ${RBAC_SERVICE_PATH}
        - name: RBAC_CACHE_TTL
          value: ${RBAC_CACHE_TTL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: POD_CPU_LIMIT
          valueFrom:
            resourceFieldRef:
              containerName: koku-api-writes
              resource: limits.cpu
        - name: GUNICORN_WORKERS
          value: ${GUNICORN_WORKERS}
        - name: GUNICORN_THREADS
          value: ${GUNICORN_THREADS}
        - name: ACCOUNT_ENHANCED_METRICS
          value: ${ACCOUNT_ENHANCED_METRICS}
        - name: CACHED_VIEWS_DISABLED
          value: ${CACHED_VIEWS_DISABLED}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: NOTIFICATION_CHECK_TIME
          value: ${NOTIFICATION_CHECK_TIME}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        - name: RBAC_CACHE_TIMEOUT
          value: ${RBAC_CACHE_TIMEOUT}
        - name: CACHE_TIMEOUT
          value: ${CACHE_TIMEOUT}
        - name: TAG_ENABLED_LIMIT
          value: ${TAG_ENABLED_LIMIT}
        image: ${IMAGE}:${IMAGE_TAG}
        initContainers:
        - command:
          - /bin/bash
          - -c
          - $APP_ROOT/scripts/run_migrations.sh
          image: ${IMAGE}:${IMAGE_TAG}
          inheritEnv: true
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: ${API_PATH_PREFIX}/v1/status/
            port: web
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: ${API_PATH_PREFIX}/v1/status/
            port: web
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_KOKU_WRITES}
            memory: ${MEMORY_LIMIT_KOKU_WRITES}
          requests:
            cpu: ${CPU_REQUEST_KOKU_WRITES}
            memory: ${MEMORY_REQUEST_KOKU_WRITES}
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{KOKU_WRITES_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: true
    - name: clowder-api
      podSpec:
        command:
        - nginx
        - -g
        - daemon off;
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: ROS_OCP_API
          value: ${ROS_OCP_API}
        image: ${NGINX_IMAGE}:${NGINX_IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /healthz
            port: web
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /healthz
            port: web
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_NGINX}
            memory: ${MEMORY_LIMIT_NGINX}
          requests:
            cpu: ${CPU_REQUEST_NGINX}
            memory: ${MEMORY_REQUEST_NGINX}
        volumeMounts:
        - mountPath: /etc/nginx
          name: koku-api-nginx-conf
        volumes:
        - configMap:
            name: koku-api-nginx-conf
          name: koku-api-nginx-conf
      replicas: ${{NGINX_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          apiPath: cost-management
          enabled: true
    - name: clowder-listener
      podSpec:
        command:
        - /bin/bash
        - -c
        - python koku/manage.py listener
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: KAFKA_CONNECT
          value: ${KAFKA_CONNECT}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: KOKU_LOG_LEVEL
          value: ${LISTENER_KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: DJANGO_LOG_LEVEL
          value: ${DJANGO_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: REQUESTED_ROS_BUCKET
          value: ${S3_ROS_BUCKET_NAME}
        - name: ROS_URL_EXPIRATION
          value: ${ROS_URL_EXPIRATION}
        - name: DISABLE_ROS_MSG
          value: ${DISABLE_ROS_MSG}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_LISTENER}
            memory: ${MEMORY_LIMIT_LISTENER}
          requests:
            cpu: ${CPU_REQUEST_LISTENER}
            memory: ${MEMORY_REQUEST_LISTENER}
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-listener-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-listener-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{LISTENER_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod as currently it supports only internal administrative api
      name: clowder-masu
      podSpec:
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: MASU
          value: "true"
        - name: DJANGO_SECRET_KEY
          valueFrom:
            secretKeyRef:
              key: django-secret-key
              name: koku-secret
              optional: false
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: API_PATH_PREFIX
          value: ${API_PATH_PREFIX}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_DOMAIN
          value: ${APP_DOMAIN}
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: GUNICORN_LOG_LEVEL
          value: ${GUNICORN_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${MASU_KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: DJANGO_LOG_LEVEL
          value: ${DJANGO_LOG_LEVEL}
        - name: DJANGO_LOG_FORMATTER
          value: ${DJANGO_LOG_FORMATTER}
        - name: DJANGO_LOG_HANDLERS
          value: ${DJANGO_LOG_HANDLERS}
        - name: DJANGO_LOG_DIRECTORY
          value: ${DJANGO_LOG_DIRECTORY}
        - name: DJANGO_LOGGING_FILE
          value: ${DJANGO_LOG_FILE}
        - name: RBAC_SERVICE_PATH
          value: ${RBAC_SERVICE_PATH}
        - name: RBAC_CACHE_TTL
          value: ${RBAC_CACHE_TTL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: POD_CPU_LIMIT
          valueFrom:
            resourceFieldRef:
              containerName: koku-clowder-masu
              resource: limits.cpu
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: ACCOUNT_ENHANCED_METRICS
          value: ${ACCOUNT_ENHANCED_METRICS}
        - name: CACHED_VIEWS_DISABLED
          value: ${CACHED_VIEWS_DISABLED}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: NOTIFICATION_CHECK_TIME
          value: ${NOTIFICATION_CHECK_TIME}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: TAG_ENABLED_LIMIT
          value: ${TAG_ENABLED_LIMIT}
        - name: KAFKA_CONNECT
          value: ${KAFKA_CONNECT}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: ${API_PATH_PREFIX}/v1/status/?liveness
            port: private
            scheme: HTTP
          initialDelaySeconds: 45
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 15
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod as currently it supports only internal administrative api
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: ${API_PATH_PREFIX}/v1/status/
            port: private
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_MASU}
            memory: ${MEMORY_LIMIT_MASU}
          requests:
            cpu: ${CPU_REQUEST_MASU}
            memory: ${MEMORY_REQUEST_MASU}
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{MASU_REPLICAS}}
      webServices:
        private:
          enabled: true
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod as currently scheduling is a singleton
          ignore-check.kube-linter.io/no-liveness-probe: This deployment uses celery
            beat which does not easily support liveness checks
          ignore-check.kube-linter.io/no-readiness-probe: This deployment uses celery
            beat which does not easily support readiness checks
      name: clowder-scheduler
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku beat -l $CELERY_LOG_LEVEL
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${SCHEDULER_WORKER_QUEUE}
        - name: REPORT_DOWNLOAD_SCHEDULE
          value: ${REPORT_DOWNLOAD_SCHEDULE}
        - name: SCHEDULE_REPORT_CHECKS
          value: ${SCHEDULE_REPORT_CHECKS}
        - name: SOURCE_STATUS_SCHEDULE
          value: ${SOURCE_STATUS_SCHEDULE}
        - name: REMOVE_EXPIRED_REPORT_DATA_ON_DAY
          value: ${REMOVE_EXPIRED_REPORT_DATA_ON_DAY}
        - name: REMOVE_EXPIRED_REPORT_UTC_TIME
          value: ${REMOVE_EXPIRED_REPORT_UTC_TIME}
        - name: VACUUM_DATA_DAY_OF_WEEK
          value: ${VACUUM_DATA_DAY_OF_WEEK}
        - name: VACUUM_DATA_UTC_TIME
          value: ${VACUUM_DATA_UTC_TIME}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod as currently scheduling is a singleton
            ignore-check.kube-linter.io/no-liveness-probe: This deployment uses celery
              beat which does not easily support liveness checks
            ignore-check.kube-linter.io/no-readiness-probe: This deployment uses celery
              beat which does not easily support readiness checks
        resources:
          limits:
            cpu: ${CPU_LIMIT_SCHEDULER}
            memory: ${MEMORY_LIMIT_SCHEDULER}
          requests:
            cpu: ${CPU_REQUEST_SCHEDULER}
            memory: ${MEMORY_REQUEST_SCHEDULER}
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{SCHEDULER_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-sources-client
      podSpec:
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: SOURCES
          value: "true"
        - name: SOURCES_PROBE_HEADER
          value: ${SOURCES_PROBE_HEADER}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: DJANGO_SECRET_KEY
          valueFrom:
            secretKeyRef:
              key: django-secret-key
              name: koku-secret
              optional: false
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: API_PATH_PREFIX
          value: ${API_PATH_PREFIX}
        - name: APP_DOMAIN
          value: ${APP_DOMAIN}
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: GUNICORN_LOG_LEVEL
          value: ${GUNICORN_LOG_LEVEL}
        - name: GUNICORN_WORKERS
          value: ${GUNICORN_WORKERS}
        - name: KOKU_LOG_LEVEL
          value: ${SOURCES_CLIENT_KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: DJANGO_LOG_LEVEL
          value: ${DJANGO_LOG_LEVEL}
        - name: DJANGO_LOG_FORMATTER
          value: ${DJANGO_LOG_FORMATTER}
        - name: DJANGO_LOG_HANDLERS
          value: ${DJANGO_LOG_HANDLERS}
        - name: DJANGO_LOG_DIRECTORY
          value: ${DJANGO_LOG_DIRECTORY}
        - name: DJANGO_LOGGING_FILE
          value: ${DJANGO_LOG_FILE}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: RBAC_SERVICE_PATH
          value: ${RBAC_SERVICE_PATH}
        - name: RBAC_CACHE_TTL
          value: ${RBAC_CACHE_TTL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: ${API_PATH_PREFIX}/v1/status/?liveness
            port: private
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: ${API_PATH_PREFIX}/v1/status/
            port: private
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_SOURCES_CLIENT}
            memory: ${MEMORY_LIMIT_SOURCES_CLIENT}
          requests:
            cpu: ${CPU_REQUEST_SOURCES_CLIENT}
            memory: ${MEMORY_REQUEST_SOURCES_CLIENT}
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{SOURCES_CLIENT_REPLICAS}}
      webServices:
        private:
          enabled: true
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod as currently sources integration requires in order message handling,
            which can fail with multiple consumers due to race conditions
      name: clowder-sources-listener
      podSpec:
        command:
        - /bin/bash
        - -c
        - python koku/manage.py sources_listener
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: SOURCES
          value: "true"
        - name: SOURCES_PROBE_HEADER
          value: ${SOURCES_PROBE_HEADER}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: DJANGO_SECRET_KEY
          valueFrom:
            secretKeyRef:
              key: django-secret-key
              name: koku-secret
              optional: false
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: API_PATH_PREFIX
          value: ${API_PATH_PREFIX}
        - name: APP_DOMAIN
          value: ${APP_DOMAIN}
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: KOKU_LOG_LEVEL
          value: ${SOURCES_LISTENER_KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: DJANGO_LOG_LEVEL
          value: ${DJANGO_LOG_LEVEL}
        - name: DJANGO_LOG_FORMATTER
          value: ${DJANGO_LOG_FORMATTER}
        - name: DJANGO_LOG_HANDLERS
          value: ${DJANGO_LOG_HANDLERS}
        - name: DJANGO_LOG_DIRECTORY
          value: ${DJANGO_LOG_DIRECTORY}
        - name: DJANGO_LOGGING_FILE
          value: ${DJANGO_LOG_FILE}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: RBAC_SERVICE_PATH
          value: ${RBAC_SERVICE_PATH}
        - name: RBAC_CACHE_TTL
          value: ${RBAC_CACHE_TTL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod as currently sources integration requires in order message handling,
              which can fail with multiple consumers due to race conditions
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_SOURCES_LISTENER}
            memory: ${MEMORY_LIMIT_SOURCES_LISTENER}
          requests:
            cpu: ${CPU_REQUEST_SOURCES_LISTENER}
            memory: ${MEMORY_REQUEST_SOURCES_LISTENER}
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{SOURCES_LISTENER_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-worker-celery
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_CELERY_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_CELERY}
            memory: ${MEMORY_LIMIT_WORKER_CELERY}
          requests:
            cpu: ${CPU_REQUEST_WORKER_CELERY}
            memory: ${MEMORY_REQUEST_WORKER_CELERY}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_CELERY_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-worker-cost-model
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_COST_MODEL_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_COST_MODEL}
            memory: ${MEMORY_LIMIT_WORKER_COST_MODEL}
          requests:
            cpu: ${CPU_REQUEST_WORKER_COST_MODEL}
            memory: ${MEMORY_REQUEST_WORKER_COST_MODEL}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_COST_MODEL_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-worker-cost-model-xl
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_COST_MODEL_XL_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_COST_MODEL_XL}
            memory: ${MEMORY_LIMIT_WORKER_COST_MODEL_XL}
          requests:
            cpu: ${CPU_REQUEST_WORKER_COST_MODEL_XL}
            memory: ${MEMORY_REQUEST_WORKER_COST_MODEL_XL}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_COST_MODEL_XL_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-worker-cost-model-penalty
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_COST_MODEL_PENALTY_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_COST_MODEL_PENALTY}
            memory: ${MEMORY_LIMIT_WORKER_COST_MODEL_PENALTY}
          requests:
            cpu: ${CPU_REQUEST_WORKER_COST_MODEL_PENALTY}
            memory: ${MEMORY_REQUEST_WORKER_COST_MODEL_PENALTY}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_COST_MODEL_PENALTY_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - autoScaler:
        fallback:
          behavior: currentReplicasIfHigher
          failureThreshold: 3
          replicas: ${{WORKER_DOWNLOAD_FALLBACK_REPLICAS}}
        maxReplicaCount: ${{WORKER_DOWNLOAD_MAX_REPLICAS}}
        minReplicaCount: ${{WORKER_DOWNLOAD_MIN_REPLICAS}}
        triggers:
        - metadata:
            query: ${WORKER_DOWNLOAD_TRIGGER_QUERY}
            threshold: ${WORKER_DOWNLOAD_TRIGGER_THRESHOLD}
          type: prometheus
      metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-worker-download
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: PANDAS_COLUMN_BATCH_SIZE
          value: ${PANDAS_COLUMN_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_DOWNLOAD_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: TAG_ENABLED_LIMIT
          value: ${TAG_ENABLED_LIMIT}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_DOWNLOAD}
            memory: ${MEMORY_LIMIT_WORKER_DOWNLOAD}
          requests:
            cpu: ${CPU_REQUEST_WORKER_DOWNLOAD}
            memory: ${MEMORY_REQUEST_WORKER_DOWNLOAD}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-worker-download-xl
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: PANDAS_COLUMN_BATCH_SIZE
          value: ${PANDAS_COLUMN_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_DOWNLOAD_XL_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: TAG_ENABLED_LIMIT
          value: ${TAG_ENABLED_LIMIT}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_DOWNLOAD_XL}
            memory: ${MEMORY_LIMIT_WORKER_DOWNLOAD_XL}
          requests:
            cpu: ${CPU_REQUEST_WORKER_DOWNLOAD_XL}
            memory: ${MEMORY_REQUEST_WORKER_DOWNLOAD_XL}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_DOWNLOAD_XL_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-worker-download-penalty
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: PANDAS_COLUMN_BATCH_SIZE
          value: ${PANDAS_COLUMN_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_DOWNLOAD_PENALTY_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: TAG_ENABLED_LIMIT
          value: ${TAG_ENABLED_LIMIT}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_DOWNLOAD_PENALTY}
            memory: ${MEMORY_LIMIT_WORKER_DOWNLOAD_PENALTY}
          requests:
            cpu: ${CPU_REQUEST_WORKER_DOWNLOAD_PENALTY}
            memory: ${MEMORY_REQUEST_WORKER_DOWNLOAD_PENALTY}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_DOWNLOAD_PENALTY_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-worker-ocp
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_OCP_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: TAG_ENABLED_LIMIT
          value: ${TAG_ENABLED_LIMIT}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_OCP}
            memory: ${MEMORY_LIMIT_WORKER_OCP}
          requests:
            cpu: ${CPU_REQUEST_WORKER_OCP}
            memory: ${MEMORY_REQUEST_WORKER_OCP}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_OCP_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-worker-ocp-xl
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_OCP_XL_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: TAG_ENABLED_LIMIT
          value: ${TAG_ENABLED_LIMIT}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_OCP_XL}
            memory: ${MEMORY_LIMIT_WORKER_OCP_XL}
          requests:
            cpu: ${CPU_REQUEST_WORKER_OCP_XL}
            memory: ${MEMORY_REQUEST_WORKER_OCP_XL}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_OCP_XL_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-worker-ocp-penalty
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_OCP_PENALTY_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: TAG_ENABLED_LIMIT
          value: ${TAG_ENABLED_LIMIT}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_OCP_PENALTY}
            memory: ${MEMORY_LIMIT_WORKER_OCP_PENALTY}
          requests:
            cpu: ${CPU_REQUEST_WORKER_OCP_PENALTY}
            memory: ${MEMORY_REQUEST_WORKER_OCP_PENALTY}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_OCP_PENALTY_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-worker-priority
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: PANDAS_COLUMN_BATCH_SIZE
          value: ${PANDAS_COLUMN_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_PRIORITY_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: DELAYED_TASK_TIME
          value: ${DELAYED_TASK_TIME}
        - name: DELAYED_TASK_POLLING_MINUTES
          value: ${DELAYED_TASK_POLLING_MINUTES}
        - name: TAG_ENABLED_LIMIT
          value: ${TAG_ENABLED_LIMIT}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_PRIORITY}
            memory: ${MEMORY_LIMIT_WORKER_PRIORITY}
          requests:
            cpu: ${CPU_REQUEST_WORKER_PRIORITY}
            memory: ${MEMORY_REQUEST_WORKER_PRIORITY}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_PRIORITY_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-worker-priority-xl
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: PANDAS_COLUMN_BATCH_SIZE
          value: ${PANDAS_COLUMN_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_PRIORITY_XL_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: DELAYED_TASK_TIME
          value: ${DELAYED_TASK_TIME}
        - name: DELAYED_TASK_POLLING_MINUTES
          value: ${DELAYED_TASK_POLLING_MINUTES}
        - name: TAG_ENABLED_LIMIT
          value: ${TAG_ENABLED_LIMIT}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_PRIORITY_XL}
            memory: ${MEMORY_LIMIT_WORKER_PRIORITY_XL}
          requests:
            cpu: ${CPU_REQUEST_WORKER_PRIORITY_XL}
            memory: ${MEMORY_REQUEST_WORKER_PRIORITY_XL}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_PRIORITY_XL_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-worker-priority-penalty
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: PANDAS_COLUMN_BATCH_SIZE
          value: ${PANDAS_COLUMN_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_PRIORITY_PENALTY_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: DELAYED_TASK_TIME
          value: ${DELAYED_TASK_TIME}
        - name: DELAYED_TASK_POLLING_MINUTES
          value: ${DELAYED_TASK_POLLING_MINUTES}
        - name: TAG_ENABLED_LIMIT
          value: ${TAG_ENABLED_LIMIT}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_PRIORITY_PENALTY}
            memory: ${MEMORY_LIMIT_WORKER_PRIORITY_PENALTY}
          requests:
            cpu: ${CPU_REQUEST_WORKER_PRIORITY_PENALTY}
            memory: ${MEMORY_REQUEST_WORKER_PRIORITY_PENALTY}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_PRIORITY_PENALTY_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-worker-refresh
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_REFRESH_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_REFRESH}
            memory: ${MEMORY_LIMIT_WORKER_REFRESH}
          requests:
            cpu: ${CPU_REQUEST_WORKER_REFRESH}
            memory: ${MEMORY_REQUEST_WORKER_REFRESH}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_REFRESH_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-worker-refresh-xl
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_REFRESH_XL_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_REFRESH_XL}
            memory: ${MEMORY_LIMIT_WORKER_REFRESH_XL}
          requests:
            cpu: ${CPU_REQUEST_WORKER_REFRESH_XL}
            memory: ${MEMORY_REQUEST_WORKER_REFRESH_XL}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_REFRESH_XL_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-worker-refresh-penalty
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_REFRESH_PENALTY_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_REFRESH_PENALTY}
            memory: ${MEMORY_LIMIT_WORKER_REFRESH_PENALTY}
          requests:
            cpu: ${CPU_REQUEST_WORKER_REFRESH_PENALTY}
            memory: ${MEMORY_REQUEST_WORKER_REFRESH_PENALTY}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_REFRESH_PENALTY_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-worker-summary
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_SUMMARY_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: DELAYED_TASK_TIME
          value: ${DELAYED_TASK_TIME}
        - name: DELAYED_TASK_POLLING_MINUTES
          value: ${DELAYED_TASK_POLLING_MINUTES}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_SUMMARY}
            memory: ${MEMORY_LIMIT_WORKER_SUMMARY}
          requests:
            cpu: ${CPU_REQUEST_WORKER_SUMMARY}
            memory: ${MEMORY_REQUEST_WORKER_SUMMARY}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_SUMMARY_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-worker-summary-xl
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_SUMMARY_XL_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: DELAYED_TASK_TIME
          value: ${DELAYED_TASK_TIME}
        - name: DELAYED_TASK_POLLING_MINUTES
          value: ${DELAYED_TASK_POLLING_MINUTES}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_SUMMARY_XL}
            memory: ${MEMORY_LIMIT_WORKER_SUMMARY_XL}
          requests:
            cpu: ${CPU_REQUEST_WORKER_SUMMARY_XL}
            memory: ${MEMORY_REQUEST_WORKER_SUMMARY_XL}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_SUMMARY_XL_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-worker-summary-penalty
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_SUMMARY_PENALTY_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: DELAYED_TASK_TIME
          value: ${DELAYED_TASK_TIME}
        - name: DELAYED_TASK_POLLING_MINUTES
          value: ${DELAYED_TASK_POLLING_MINUTES}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_SUMMARY_PENALTY}
            memory: ${MEMORY_LIMIT_WORKER_SUMMARY_PENALTY}
          requests:
            cpu: ${CPU_REQUEST_WORKER_SUMMARY_PENALTY}
            memory: ${MEMORY_REQUEST_WORKER_SUMMARY_PENALTY}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_SUMMARY_PENALTY_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - metadata:
        annotations:
          ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
            1 pod at times for cost saving purposes
      name: clowder-worker-hcs
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: ENABLE_HCS_DEBUG
          value: ${ENABLE_HCS_DEBUG}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_HCS_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: POLLING_TIMER
          value: ${POLLING_TIMER}
        - name: POLLING_COUNT
          value: ${POLLING_COUNT}
        - name: XL_REPORT_COUNT
          value: ${XL_REPORT_COUNT}
        - name: PROCESSING_WAIT_TIMER
          value: ${PROCESSING_WAIT_TIMER}
        - name: LARGE_PROCESSING_WAIT_TIMER
          value: ${LARGE_PROCESSING_WAIT_TIMER}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: AUTO_DATA_INGEST
          value: ${AUTO_DATA_INGEST}
        - name: REPORT_PROCESSING_BATCH_SIZE
          value: ${REPORT_PROCESSING_BATCH_SIZE}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        metadata:
          annotations:
            ignore-check.kube-linter.io/minimum-three-replicas: This deployment uses
              1 pod at times for cost saving purposes
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_HCS}
            memory: ${MEMORY_LIMIT_WORKER_HCS}
          requests:
            cpu: ${CPU_REQUEST_WORKER_HCS}
            memory: ${MEMORY_REQUEST_WORKER_HCS}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_HCS_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - name: clowder-worker-subs-extraction
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: ENABLE_SUBS_DEBUG
          value: ${ENABLE_SUBS_DEBUG}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: REQUESTED_SUBS_BUCKET
          value: ${S3_SUBS_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_SUBS_EXTRACTION_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        - name: ENABLE_SUBS_DEBUG
          value: ${ENABLE_SUBS_DEBUG}
        - name: ENABLE_SUBS_PROVIDER_TYPES
          value: ${ENABLE_SUBS_PROVIDER_TYPES}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_SUBS_EXTRACTION}
            memory: ${MEMORY_LIMIT_WORKER_SUBS_EXTRACTION}
          requests:
            cpu: ${CPU_REQUEST_WORKER_SUBS_EXTRACTION}
            memory: ${MEMORY_REQUEST_WORKER_SUBS_EXTRACTION}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_SUBS_EXTRACTION_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    - name: clowder-worker-subs-transmission
      podSpec:
        command:
        - /bin/bash
        - -c
        - |
          PYTHONPATH=${APP_HOME} celery -A koku worker --without-gossip -E -l $CELERY_LOG_LEVEL -Q $WORKER_QUEUES
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: ${GOOGLE_APPLICATION_CREDENTIALS}
        - name: SOURCES_PSK
          valueFrom:
            secretKeyRef:
              key: psk
              name: ${SOURCES_PSK_SECRET_NAME}
              optional: true
        - name: APP_POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: ENABLE_SUBS_DEBUG
          value: ${ENABLE_SUBS_DEBUG}
        - name: CELERY_LOG_LEVEL
          value: ${CELERY_LOG_LEVEL}
        - name: KOKU_LOG_LEVEL
          value: ${KOKU_LOG_LEVEL}
        - name: UNLEASH_LOG_LEVEL
          value: ${UNLEASH_LOG_LEVEL}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: REQUESTED_BUCKET
          value: ${S3_BUCKET_NAME}
        - name: REQUESTED_SUBS_BUCKET
          value: ${S3_SUBS_BUCKET_NAME}
        - name: PARQUET_PROCESSING_BATCH_SIZE
          value: ${PARQUET_PROCESSING_BATCH_SIZE}
        - name: TRINO_DATE_STEP
          value: ${TRINO_DATE_STEP}
        - name: VALIDATION_RANGE
          value: ${VALIDATION_RANGE}
        - name: KOKU_ENABLE_SENTRY
          value: ${KOKU_ENABLE_SENTRY}
        - name: KOKU_SENTRY_ENVIRONMENT
          value: ${KOKU_SENTRY_ENV}
        - name: KOKU_SENTRY_DSN
          valueFrom:
            secretKeyRef:
              key: ${GLITCHTIP_KEY_NAME}
              name: ${GLITCHTIP_SECRET_NAME}
              optional: true
        - name: DEMO_ACCOUNTS
          value: ${DEMO_ACCOUNTS}
        - name: WORKER_QUEUES
          value: ${WORKER_SUBS_TRANSMISSION_WORKER_QUEUE}
        - name: WORKER_PROC_ALIVE_TIMEOUT
          value: ${WORKER_PROC_ALIVE_TIMEOUT}
        - name: DATE_OVERRIDE
          value: ${DATE_OVERRIDE}
        - name: RETAIN_NUM_MONTHS
          value: ${RETAIN_NUM_MONTHS}
        - name: INITIAL_INGEST_NUM_MONTHS
          value: ${INITIAL_INGEST_NUM_MONTHS}
        - name: INITIAL_INGEST_OVERRIDE
          value: ${INITIAL_INGEST_OVERRIDE}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        - name: PROMETHEUS_PUSHGATEWAY
          value: ${PROMETHEUS_PUSHGATEWAY}
        - name: SOURCES_API_PREFIX
          value: ${SOURCES_API_PREFIX}
        - name: UNLEASH_CACHE_DIR
          value: ${UNLEASH_CACHE_DIR}
        - name: WORKER_CACHE_TIMEOUT
          value: ${WORKER_CACHE_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
          value: ${WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT}
        - name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
          value: ${WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS}
        - name: QE_SCHEMA
          value: ${QE_SCHEMA}
        - name: ENHANCED_ORG_ADMIN
          value: ${ENHANCED_ORG_ADMIN}
        - name: ENABLE_SUBS_DEBUG
          value: ${ENABLE_SUBS_DEBUG}
        image: ${IMAGE}:${IMAGE_TAG}
        livenessProbe:
          failureThreshold: 5
          httpGet:
            path: /livez
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        readinessProbe:
          failureThreshold: 5
          httpGet:
            path: /readyz
            port: metrics
            scheme: HTTP
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 10
        resources:
          limits:
            cpu: ${CPU_LIMIT_WORKER_SUBS_TRANSMISSION}
            memory: ${MEMORY_LIMIT_WORKER_SUBS_TRANSMISSION}
          requests:
            cpu: ${CPU_REQUEST_WORKER_SUBS_TRANSMISSION}
            memory: ${MEMORY_REQUEST_WORKER_SUBS_TRANSMISSION}
        terminationGracePeriodSeconds: 3600
        volumeMounts:
        - mountPath: /etc/aws
          name: aws-credentials
          readOnly: true
        - mountPath: /var/tmp/masu/
          name: koku-worker-data
        - mountPath: /etc/gcp
          name: gcp-credentials
          readOnly: true
        - mountPath: ${TMP_DIR}
          name: tmp-data
        volumes:
        - emptyDir: {}
          name: tmp-data
        - emptyDir: {}
          name: koku-worker-data
        - name: aws-credentials
          secret:
            items:
            - key: aws-credentials
              path: aws-credentials
            secretName: koku-aws
        - name: gcp-credentials
          secret:
            items:
            - key: gcp-credentials
              path: gcp-credentials.json
            secretName: koku-gcp
      replicas: ${{WORKER_SUBS_TRANSMISSION_REPLICAS}}
      webServices:
        private:
          enabled: false
        public:
          enabled: false
    envName: ${ENV_NAME}
    featureFlags: true
    inMemoryDb: true
    jobs:
    - name: db-migrate-cji-${DBM_IMAGE_TAG}-${DBM_INVOCATION}
      podSpec:
        args:
        - /bin/bash
        - -c
        - $APP_ROOT/scripts/run_migrations.sh
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: PROMETHEUS_MULTIPROC_DIR
          value: ${PROMETHEUS_DIR}
        - name: DBM_IMAGE
          value: ${DBM_IMAGE}
        - name: DBM_IMAGE_TAG
          value: ${DBM_IMAGE_TAG}
        - name: DBM_INVOCATION
          value: ${DBM_INVOCATION}
        - name: _MIGRATION_DIRECTIVE
          value: ${_MIGRATION_DIRECTIVE}
        - name: TENANT_MULTIPROCESSING_MAX_PROCESSES
          value: ${TENANT_MULTIPROCESSING_MAX_PROCESSES}
        - name: TENANT_MULTIPROCESSING_CHUNKS
          value: ${TENANT_MULTIPROCESSING_CHUNKS}
        image: ${DBM_IMAGE}:${DBM_IMAGE_TAG}
        resources:
          limits:
            cpu: ${CPU_LIMIT_KOKU_MIGRATIONS}
            memory: ${MEMORY_LIMIT_KOKU_MIGRATIONS}
          requests:
            cpu: ${CPU_REQUEST_KOKU_MIGRATIONS}
            memory: ${MEMORY_REQUEST_KOKU_MIGRATIONS}
    - name: management-command-cji-${MGMT_IMAGE_TAG}-${MGMT_INVOCATION}
      podSpec:
        args:
        - /bin/bash
        - -c
        - ${MGMT_COMMAND}
        env:
        - name: CLOWDER_ENABLED
          value: ${CLOWDER_ENABLED}
        - name: AWS_SHARED_CREDENTIALS_FILE
          value: ${AWS_SHARED_CREDENTIALS_FILE}
        - name: SCHEMA_SUFFIX
          value: ${SCHEMA_SUFFIX}
        - name: TRINO_S3A_OR_S3
          value: ${TRINO_S3A_OR_S3}
        - name: DEVELOPMENT
          value: ${DEVELOPMENT}
        - name: MGMT_IMAGE
          value: ${MGMT_IMAGE}
        - name: MGMT_IMAGE_TAG
          value: ${MGMT_IMAGE_TAG}
        - name: TRINO_HOST
          value: ${TRINO_HOST}
        - name: TRINO_PORT
          value: ${TRINO_PORT}
        image: ${MGMT_IMAGE}:${MGMT_IMAGE_TAG}
        resources:
          limits:
            cpu: ${CPU_LIMIT_KOKU_MGMT}
            memory: ${MEMORY_LIMIT_KOKU_MGMT}
          requests:
            cpu: ${CPU_REQUEST_KOKU_MGMT}
            memory: ${MEMORY_REQUEST_KOKU_MGMT}
    kafkaTopics:
    - topicName: platform.sources.event-stream
    - topicName: platform.upload.announce
    - topicName: platform.upload.validation
    - topicName: platform.notifications.ingress
    - topicName: hccm.ros.events
    - topicName: platform.rhsm-subscriptions.service-instance-ingress
    objectStore:
    - ${S3_BUCKET_NAME}
    - ${S3_ROS_BUCKET_NAME}
    - ${S3_SUBS_BUCKET_NAME}
    optionalDependencies: []
    testing:
      iqePlugin: cost-management
- apiVersion: cloud.redhat.com/v1alpha1
  kind: ClowdJobInvocation
  metadata:
    name: db-migrate-cji-${DBM_IMAGE_TAG}-${DBM_INVOCATION}
  spec:
    appName: koku
    jobs:
    - db-migrate-cji-${DBM_IMAGE_TAG}-${DBM_INVOCATION}
- apiVersion: cloud.redhat.com/v1alpha1
  kind: ClowdJobInvocation
  metadata:
    name: management-command-cji-${MGMT_IMAGE_TAG}-${MGMT_INVOCATION}
  spec:
    appName: koku
    jobs:
    - management-command-cji-${MGMT_IMAGE_TAG}-${MGMT_INVOCATION}
- apiVersion: v1
  data:
    django-secret-key: ${SECRET_KEY}
  kind: Secret
  metadata:
    name: koku-secret
- apiVersion: v1
  data:
    nginx.conf: |-
      worker_processes  1;
      error_log  /dev/stderr warn;
      pid        /run/nginx.pid;

      events {
        worker_connections  1024;
      }
      http {
        log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_proto" "$http_x_forwarded_for"';

        access_log  /dev/stdout  main;

        sendfile            on;
        tcp_nopush          on;
        tcp_nodelay         on;
        keepalive_timeout   65;
        server_tokens       off;

        upstream koku-api-reads {
          server koku-api-reads:8000;
        }
        upstream koku-api-writes {
          server koku-api-writes:8000;
        }
        upstream ros-ocp-api {
          server ${ROS_OCP_API}:8000;
        }
        map $request_method $upstream_location {
                    GET     koku-api-reads;
                    HEAD    koku-api-reads;
                    POST    koku-api-writes;
                    PUT     koku-api-writes;
                    DELETE  koku-api-writes;
                    default koku-api-writes;
        }

        server {
          error_log  stderr;
          listen 8000;
          listen 9000;

          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_set_header X-Forwarded-Proto $http_x_forwarded_proto;
          proxy_set_header Host $http_host;
          proxy_redirect off;

          client_max_body_size 500M;
          client_header_buffer_size 46k;
          location /healthz {
              auth_basic          off;
              allow               all;
              return              200;
          }
          location /metrics {
              auth_basic          off;
              allow               all;
              return              200;
          }
          location ^~/ {
            proxy_pass http://$upstream_location;
            proxy_read_timeout 600s;
          }
          location /api/cost-management/v1/recommendations/ {
            proxy_pass http://ros-ocp-api;
            proxy_read_timeout 600s;
          }
        }
      }
  kind: ConfigMap
  metadata:
    name: koku-api-nginx-conf
parameters:
- name: ENV_NAME
  required: true
  value: koku-env
- name: DATABASE_NAME
  required: true
  value: koku
- name: DATABASE_VERSION
  required: true
  value: "16"
- name: CLOWDER_ENABLED
  required: true
  value: "True"
- description: Image tag
  name: IMAGE_TAG
  required: true
  value: latest
- description: Image
  name: IMAGE
  required: true
  value: quay.io/redhat-services-prod/cost-mgmt-dev-tenant/koku
- description: DEVELOPMENT ONLY - used to prevent clashing Glue databases during ephemeral
    testing
  name: SCHEMA_SUFFIX
  value: ""
- name: TRINO_S3A_OR_S3
  value: s3a
- name: S3_BUCKET_NAME
  value: hccm-eph-s3
- name: S3_ROS_BUCKET_NAME
  value: hccm-ros-eph-s3
- name: S3_SUBS_BUCKET_NAME
  value: hccm-subs-eph-s3
- name: AWS_SHARED_CREDENTIALS_FILE
  value: /etc/aws/aws-credentials
- description: GCP Credentials Location
  name: GOOGLE_APPLICATION_CREDENTIALS
  value: /etc/gcp/gcp-credentials.json
- description: secret containing Glitchtip (or Sentry) credentials
  name: GLITCHTIP_SECRET_NAME
  value: koku-sentry
- name: GLITCHTIP_KEY_NAME
  value: dsn
- description: DB Migrations Image Tag
  name: DBM_IMAGE_TAG
  required: true
  value: latest
- description: DB Migrations Image
  name: DBM_IMAGE
  required: true
  value: quay.io/redhat-services-prod/cost-mgmt-dev-tenant/koku
- description: DB Invocation Iterator
  name: DBM_INVOCATION
  required: true
  value: "00"
- description: DB Migrations Directive
  name: _MIGRATION_DIRECTIVE
  required: false
  value: ""
- displayName: Memory Request
  name: MEMORY_REQUEST_KOKU_MIGRATIONS
  required: true
  value: 1Gi
- displayName: Memory Limit
  name: MEMORY_LIMIT_KOKU_MIGRATIONS
  required: true
  value: 2Gi
- displayName: CPU Request
  name: CPU_REQUEST_KOKU_MIGRATIONS
  required: true
  value: "2"
- displayName: CPU Limit
  name: CPU_LIMIT_KOKU_MIGRATIONS
  required: true
  value: "3"
- name: TENANT_MULTIPROCESSING_MAX_PROCESSES
  required: true
  value: "2"
- name: TENANT_MULTIPROCESSING_CHUNKS
  required: true
  value: "2"
- description: Management Command Image Tag
  name: MGMT_IMAGE_TAG
  required: true
  value: latest
- description: Management Command Image
  name: MGMT_IMAGE
  required: true
  value: quay.io/redhat-services-prod/cost-mgmt-dev-tenant/koku
- description: Management Command Invocation Iterator
  name: MGMT_INVOCATION
  required: true
  value: "00"
- description: Management Command
  name: MGMT_COMMAND
  value: echo 'No Command to Run'
- displayName: Memory Request
  name: MEMORY_REQUEST_KOKU_MGMT
  required: true
  value: 20Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_KOKU_MGMT
  required: true
  value: 20Mi
- displayName: CPU Request
  name: CPU_REQUEST_KOKU_MGMT
  required: true
  value: 10m
- displayName: CPU Limit
  name: CPU_LIMIT_KOKU_MGMT
  required: true
  value: 10m
- displayName: App domain
  name: APP_DOMAIN
  value: project-koku.com
- displayName: API path prefix
  name: API_PATH_PREFIX
  required: true
  value: /api/cost-management
- displayName: Max support group by
  name: MAX_GROUP_BY_OVERRIDE
  value: "3"
- displayName: Development
  name: DEVELOPMENT
  value: "False"
- displayName: Gunicorn worker count
  name: GUNICORN_WORKERS
  value: "3"
- displayName: Enable threads in Gunicorn
  name: GUNICORN_THREADS
  value: "True"
- displayName: Celery log level
  name: CELERY_LOG_LEVEL
  value: INFO
- displayName: Gunicorn log level
  name: GUNICORN_LOG_LEVEL
  value: INFO
- displayName: Koku log level
  name: KOKU_LOG_LEVEL
  value: INFO
- displayName: Unleash log level
  name: UNLEASH_LOG_LEVEL
  value: WARNING
- displayName: Django log level
  name: DJANGO_LOG_LEVEL
  value: INFO
- displayName: Django log formatter
  name: DJANGO_LOG_FORMATTER
  value: simple
- displayName: Django log handlers
  name: DJANGO_LOG_HANDLERS
  value: console
- displayName: Django log dir
  name: DJANGO_LOG_DIRECTORY
  required: false
- displayName: Django logging file
  name: DJANGO_LOG_FILE
  required: false
- description: Koku Sentry Env
  displayName: Koku Sentry Env
  name: KOKU_SENTRY_ENV
  value: development
- description: Enable Sentry
  displayName: Enable Sentry
  name: KOKU_ENABLE_SENTRY
  value: "False"
- description: How many CSV rows to process into a Parquet file
  displayName: Parquet processing batch size
  name: PARQUET_PROCESSING_BATCH_SIZE
  required: true
  value: "200000"
- description: How many pandas columns to read from file
  displayName: Pandas column batch size
  name: PANDAS_COLUMN_BATCH_SIZE
  required: true
  value: "250"
- description: Processing batch size
  displayName: Processing batch size
  name: REPORT_PROCESSING_BATCH_SIZE
  required: false
  value: "100000"
- description: Number of days at a time we process Trino SQL
  displayName: Trino date step
  name: TRINO_DATE_STEP
  required: true
  value: "5"
- description: Number of days to expand the data validation
  displayName: Data validation
  name: VALIDATION_RANGE
  required: true
  value: "5"
- description: Flag to use account enhanced prometheus metricsworker
  displayName: Account Enhanced Metrics
  name: ACCOUNT_ENHANCED_METRICS
  value: "False"
- description: Flag to enable/disable caching
  displayName: cached views
  name: CACHED_VIEWS_DISABLED
  value: "False"
- description: How long to store a task in the worker cache
  displayName: Worker cache timeout
  name: WORKER_CACHE_TIMEOUT
  value: "21600"
- description: How long to store an XL task in the worker cache
  displayName: Worker cache XL timeout
  name: WORKER_CACHE_LARGE_CUSTOMER_TIMEOUT
  value: "43200"
- description: How many concurrent tasks a customer can have
  displayName: Worker cache timeout
  name: WORKER_CACHE_LARGE_CUSTOMER_CONCURRENT_TASKS
  value: "2"
- description: Timeout threshold for worker process to initialize
  displayName: Worker Proc Alive Timeout
  name: WORKER_PROC_ALIVE_TIMEOUT
  value: "4"
- description: Demo account JSON
  displayName: Demo account JSON
  name: DEMO_ACCOUNTS
  value: ""
- description: Auto Ingest Flag
  displayName: AUTO_DATA_INGEST
  name: AUTO_DATA_INGEST
  value: "True"
- name: QE_SCHEMA
  value: ""
- description: Report download schedule
  displayName: Report download schedule
  name: REPORT_DOWNLOAD_SCHEDULE
  value: 0 * * * *
- description: Remove expired data on day
  displayName: Remove expired data on day
  name: REMOVE_EXPIRED_REPORT_DATA_ON_DAY
  value: "1"
- description: Remove expired data report utc time
  displayName: Remove expired data report utc time
  name: REMOVE_EXPIRED_REPORT_UTC_TIME
  value: "00:00"
- description: Vacuum data on day
  displayName: Vacuum data on day
  name: VACUUM_DATA_DAY_OF_WEEK
  value: ""
- description: Vacuum data utc time
  displayName: Vacuum data utc time
  name: VACUUM_DATA_UTC_TIME
  value: "00:00"
- displayName: Date overrider
  name: DATE_OVERRIDE
  required: false
- displayName: Retain num months
  name: RETAIN_NUM_MONTHS
  value: "3"
- displayName: Notification check period
  name: NOTIFICATION_CHECK_TIME
  value: "24"
- displayName: Initial ingest num months
  name: INITIAL_INGEST_NUM_MONTHS
  value: "3"
- displayName: Initial ingest override
  name: INITIAL_INGEST_OVERRIDE
  value: "False"
- displayName: Timer between provider polling
  name: POLLING_TIMER
  value: "86400"
- displayName: Polling count (divide total providers by this for dynamic batch size)
  name: POLLING_COUNT
  value: "21"
- description: Minimum number of reports before provider classed as XL
  displayName: Min report count for large providers
  name: XL_REPORT_COUNT
  value: "100"
- displayName: Timer to prevent triggering tasks while still processing in days
  name: PROCESSING_WAIT_TIMER
  value: "3"
- displayName: Timer to prevent triggering tasks while still processing in days
  name: LARGE_PROCESSING_WAIT_TIMER
  value: "7"
- displayName: Enable Tags Limit
  name: TAG_ENABLED_LIMIT
  value: "200"
- displayName: Delayed Resummary Time
  name: DELAYED_TASK_TIME
  value: "3600"
- displayName: Delayed Resummary Polling Minutes
  name: DELAYED_TASK_POLLING_MINUTES
  value: "30"
- displayName: ROS URL Expiration
  name: ROS_URL_EXPIRATION
  value: "172800"
- displayName: Kafka connect
  name: KAFKA_CONNECT
  value: "True"
- displayName: Rbac service path
  name: RBAC_SERVICE_PATH
  value: /api/rbac/v1/access/
- displayName: Rbac cache ttl
  name: RBAC_CACHE_TTL
  value: "30"
- displayName: Trino host
  name: TRINO_HOST
  value: trino-coordinator
- displayName: Trino port
  name: TRINO_PORT
  value: "10000"
- displayName: Prometheus Pushgateway
  name: PROMETHEUS_PUSHGATEWAY
  value: prometheus-pushgateway:9091
- description: Source API Path prefix
  name: SOURCES_API_PREFIX
  value: /api/sources/v1.0
- description: Sources PSK secret name
  name: SOURCES_PSK_SECRET_NAME
  value: sources-psk
- displayName: Temporary directory
  name: TMP_DIR
  value: /tmp
- displayName: Prometheus multiproc dir
  name: PROMETHEUS_DIR
  value: /tmp
- description: Unleash cache directory
  name: UNLEASH_CACHE_DIR
  value: /tmp/unleash
- description: Header used by liveness/readiness probes
  name: SOURCES_PROBE_HEADER
  value: eyJpZGVudGl0eSI6IHsiYWNjb3VudF9udW1iZXIiOiAiMTIzNDUiLCAib3JnX2lkIjogIjEyMzQ1In19Cg==
- displayName: Secret Key (Ephemeral)
  from: '[a-f0-9]{20}'
  generate: expression
  name: SECRET_KEY
  required: true
- description: Enhanced Org Admin
  displayName: Enhanced Org Admin
  name: ENHANCED_ORG_ADMIN
  value: "False"
- displayName: RBAC_CACHE_TIMEOUT
  name: RBAC_CACHE_TIMEOUT
  value: "300"
- displayName: Middleware Timeout
  name: CACHE_TIMEOUT
  value: "3600"
- description: Enabale Subscription Watch Debug
  displayName: Enable SUBS Debug
  name: ENABLE_SUBS_DEBUG
  value: "False"
- description: Disable ROS Kafka messages
  name: DISABLE_ROS_MSG
  value: "False"
- description: Enable SUBS Provider Types for Processing
  displayname: Enable SUBS Provider Types
  name: ENABLE_SUBS_PROVIDER_TYPES
  value: AWS
- displayName: Minimum replicas
  name: KOKU_READS_REPLICAS
  required: true
  value: "3"
- displayName: Memory Request
  name: MEMORY_REQUEST_KOKU_READS
  required: true
  value: 512Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_KOKU_READS
  required: true
  value: 1Gi
- displayName: CPU Request
  name: CPU_REQUEST_KOKU_READS
  required: true
  value: 250m
- displayName: CPU Limit
  name: CPU_LIMIT_KOKU_READS
  required: true
  value: 500m
- displayName: Log Level for koku-api
  name: KOKU_KOKU_LOG_LEVEL
  required: true
  value: INFO
- displayName: Determine whether the reads API uses the read replica
  name: USE_READREPLICA
  required: true
  value: "false"
- displayName: Determine whether the reads API uses the read replica
  name: KOKU_READ_ONLY_DB
  required: true
  value: cost-db-ro
- displayName: Minimum replicas
  name: KOKU_WRITES_REPLICAS
  required: true
  value: "3"
- displayName: Memory Request
  name: MEMORY_REQUEST_KOKU_WRITES
  required: true
  value: 512Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_KOKU_WRITES
  required: true
  value: 1Gi
- displayName: CPU Request
  name: CPU_REQUEST_KOKU_WRITES
  required: true
  value: 250m
- displayName: CPU Limit
  name: CPU_LIMIT_KOKU_WRITES
  required: true
  value: 500m
- displayName: Log Level for koku-api
  name: KOKU_KOKU_LOG_LEVEL
  required: true
  value: INFO
- displayName: Minimum replicas
  name: NGINX_REPLICAS
  required: true
  value: "3"
- displayName: Memory Request
  name: MEMORY_REQUEST_NGINX
  required: true
  value: 100Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_NGINX
  required: true
  value: 200Mi
- displayName: CPU Request
  name: CPU_REQUEST_NGINX
  required: true
  value: 100m
- displayName: CPU Limit
  name: CPU_LIMIT_NGINX
  required: true
  value: 200m
- displayName: ROS OCP API Name
  name: ROS_OCP_API
  required: true
  value: koku-api-writes
- description: Image tag
  name: NGINX_IMAGE_TAG
  required: true
  value: latest
- description: Image
  name: NGINX_IMAGE
  required: true
  value: registry.access.redhat.com/ubi9/nginx-124
- displayName: Minimum replicas
  name: LISTENER_REPLICAS
  required: true
  value: "2"
- displayName: Memory Request
  name: MEMORY_REQUEST_LISTENER
  required: true
  value: 300Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_LISTENER
  required: true
  value: 600Mi
- displayName: CPU Request
  name: CPU_REQUEST_LISTENER
  required: true
  value: 150m
- displayName: CPU Limit
  name: CPU_LIMIT_LISTENER
  required: true
  value: 300m
- displayName: Log Level for listener
  name: LISTENER_KOKU_LOG_LEVEL
  required: true
  value: INFO
- displayName: Minimum replicas
  name: MASU_REPLICAS
  required: true
  value: "1"
- displayName: Memory Request
  name: MEMORY_REQUEST_MASU
  required: true
  value: 500Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_MASU
  required: true
  value: 700Mi
- displayName: CPU Request
  name: CPU_REQUEST_MASU
  required: true
  value: 50m
- displayName: CPU Limit
  name: CPU_LIMIT_MASU
  required: true
  value: 100m
- displayName: Log Level for masu
  name: MASU_KOKU_LOG_LEVEL
  required: true
  value: INFO
- displayName: Minimum replicas
  name: SCHEDULER_REPLICAS
  required: true
  value: "1"
- displayName: Memory Request
  name: MEMORY_REQUEST_SCHEDULER
  required: true
  value: 200Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_SCHEDULER
  required: true
  value: 400Mi
- displayName: CPU Request
  name: CPU_REQUEST_SCHEDULER
  required: true
  value: 50m
- displayName: CPU Limit
  name: CPU_LIMIT_SCHEDULER
  required: true
  value: 100m
- displayName: Worker Queue
  name: SCHEDULER_WORKER_QUEUE
  required: true
  value: cost_model,cost_model_xl,cost_model_penalty,download,download_xl,download_penalty,hcs,ocp,ocp_xl,ocp_penalty,priority,priority_xl,priority_penalty,refresh,refresh_xl,refresh_penalty,summary,summary_xl,summary_penalty
- displayName: Scheduler report checks
  name: SCHEDULE_REPORT_CHECKS
  value: "True"
- displayName: Frequency to check sources availability (minutes)
  name: SOURCE_STATUS_SCHEDULE
  value: 0 3 * * *
- displayName: Minimum replicas
  name: SOURCES_CLIENT_REPLICAS
  required: true
  value: "1"
- displayName: Memory Request
  name: MEMORY_REQUEST_SOURCES_CLIENT
  required: true
  value: 650Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_SOURCES_CLIENT
  required: true
  value: 768Mi
- displayName: CPU Request
  name: CPU_REQUEST_SOURCES_CLIENT
  required: true
  value: 50m
- displayName: CPU Limit
  name: CPU_LIMIT_SOURCES_CLIENT
  required: true
  value: 100m
- displayName: Log Level for sources client
  name: SOURCES_CLIENT_KOKU_LOG_LEVEL
  required: true
  value: INFO
- displayName: Minimum replicas
  name: SOURCES_LISTENER_REPLICAS
  required: true
  value: "1"
- displayName: Memory Request
  name: MEMORY_REQUEST_SOURCES_LISTENER
  required: true
  value: 250Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_SOURCES_LISTENER
  required: true
  value: 500Mi
- displayName: CPU Request
  name: CPU_REQUEST_SOURCES_LISTENER
  required: true
  value: 100m
- displayName: CPU Limit
  name: CPU_LIMIT_SOURCES_LISTENER
  required: true
  value: 200m
- displayName: Log Level for sources listener
  name: SOURCES_LISTENER_KOKU_LOG_LEVEL
  required: true
  value: INFO
- displayName: Minimum replicas
  name: WORKER_CELERY_REPLICAS
  required: true
  value: "1"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_CELERY
  required: true
  value: 256Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_CELERY
  required: true
  value: 512Mi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_CELERY
  required: true
  value: 100m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_CELERY
  required: true
  value: 200m
- displayName: Worker Queue
  name: WORKER_CELERY_WORKER_QUEUE
  required: true
  value: celery
- displayName: Minimum replicas
  name: WORKER_COST_MODEL_REPLICAS
  required: true
  value: "2"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_COST_MODEL
  required: true
  value: 256Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_COST_MODEL
  required: true
  value: 512Mi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_COST_MODEL
  required: true
  value: 100m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_COST_MODEL
  required: true
  value: 200m
- displayName: Worker Queue
  name: WORKER_COST_MODEL_WORKER_QUEUE
  required: true
  value: cost_model
- displayName: Minimum replicas
  name: WORKER_COST_MODEL_XL_REPLICAS
  required: true
  value: "2"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_COST_MODEL_XL
  required: true
  value: 256Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_COST_MODEL_XL
  required: true
  value: 512Mi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_COST_MODEL_XL
  required: true
  value: 100m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_COST_MODEL_XL
  required: true
  value: 200m
- displayName: Worker Queue
  name: WORKER_COST_MODEL_XL_WORKER_QUEUE
  required: true
  value: cost_model_xl
- displayName: Minimum replicas
  name: WORKER_COST_MODEL_PENALTY_REPLICAS
  required: true
  value: "2"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_COST_MODEL_PENALTY
  required: true
  value: 256Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_COST_MODEL_PENALTY
  required: true
  value: 512Mi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_COST_MODEL_PENALTY
  required: true
  value: 100m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_COST_MODEL_PENALTY
  required: true
  value: 200m
- displayName: Worker Queue
  name: WORKER_COST_MODEL_PENALTY_WORKER_QUEUE
  required: true
  value: cost_model_penalty
- displayName: Minimum replicas
  name: WORKER_DOWNLOAD_MIN_REPLICAS
  required: true
  value: "1"
- displayName: Maximum replicas
  name: WORKER_DOWNLOAD_MAX_REPLICAS
  required: true
  value: "10"
- displayName: Fallback replicas
  name: WORKER_DOWNLOAD_FALLBACK_REPLICAS
  required: true
  value: "3"
- displayName: Trigger threshold
  name: WORKER_DOWNLOAD_TRIGGER_THRESHOLD
  required: true
  value: "19.5"
- displayName: Trigger query
  name: WORKER_DOWNLOAD_TRIGGER_QUERY
  required: true
  value: koku:celery:download_queue
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_DOWNLOAD
  required: true
  value: 512Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_DOWNLOAD
  required: true
  value: 1Gi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_DOWNLOAD
  required: true
  value: 200m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_DOWNLOAD
  required: true
  value: 400m
- displayName: Worker Queue
  name: WORKER_DOWNLOAD_WORKER_QUEUE
  required: true
  value: download
- displayName: Minimum replicas
  name: WORKER_DOWNLOAD_XL_REPLICAS
  required: true
  value: "2"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_DOWNLOAD_XL
  required: true
  value: 512Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_DOWNLOAD_XL
  required: true
  value: 1Gi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_DOWNLOAD_XL
  required: true
  value: 200m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_DOWNLOAD_XL
  required: true
  value: 400m
- displayName: Worker Queue
  name: WORKER_DOWNLOAD_XL_WORKER_QUEUE
  required: true
  value: download_xl
- displayName: Minimum replicas
  name: WORKER_DOWNLOAD_PENALTY_REPLICAS
  required: true
  value: "2"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_DOWNLOAD_PENALTY
  required: true
  value: 512Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_DOWNLOAD_PENALTY
  required: true
  value: 1Gi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_DOWNLOAD_PENALTY
  required: true
  value: 200m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_DOWNLOAD_PENALTY
  required: true
  value: 400m
- displayName: Worker Queue
  name: WORKER_DOWNLOAD_PENALTY_WORKER_QUEUE
  required: true
  value: download_penalty
- displayName: Minimum replicas
  name: WORKER_OCP_REPLICAS
  required: true
  value: "2"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_OCP
  required: true
  value: 256Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_OCP
  required: true
  value: 512Mi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_OCP
  required: true
  value: 100m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_OCP
  required: true
  value: 200m
- displayName: Worker Queue
  name: WORKER_OCP_WORKER_QUEUE
  required: true
  value: ocp
- displayName: Minimum replicas
  name: WORKER_OCP_XL_REPLICAS
  required: true
  value: "2"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_OCP_XL
  required: true
  value: 256Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_OCP_XL
  required: true
  value: 512Mi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_OCP_XL
  required: true
  value: 100m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_OCP_XL
  required: true
  value: 200m
- displayName: Worker Queue
  name: WORKER_OCP_XL_WORKER_QUEUE
  required: true
  value: ocp_xl
- displayName: Minimum replicas
  name: WORKER_OCP_PENALTY_REPLICAS
  required: true
  value: "2"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_OCP_PENALTY
  required: true
  value: 256Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_OCP_PENALTY
  required: true
  value: 512Mi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_OCP_PENALTY
  required: true
  value: 100m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_OCP_PENALTY
  required: true
  value: 200m
- displayName: Worker Queue
  name: WORKER_OCP_PENALTY_WORKER_QUEUE
  required: true
  value: ocp_penalty
- displayName: Minimum replicas
  name: WORKER_PRIORITY_REPLICAS
  required: true
  value: "2"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_PRIORITY
  required: true
  value: 400Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_PRIORITY
  required: true
  value: 750Mi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_PRIORITY
  required: true
  value: 100m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_PRIORITY
  required: true
  value: 200m
- displayName: Worker Queue
  name: WORKER_PRIORITY_WORKER_QUEUE
  required: true
  value: priority
- displayName: Minimum replicas
  name: WORKER_PRIORITY_XL_REPLICAS
  required: true
  value: "2"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_PRIORITY_XL
  required: true
  value: 400Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_PRIORITY_XL
  required: true
  value: 750Mi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_PRIORITY_XL
  required: true
  value: 150m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_PRIORITY_XL
  required: true
  value: 300m
- displayName: Worker Queue
  name: WORKER_PRIORITY_XL_WORKER_QUEUE
  required: true
  value: priority_xl
- displayName: Minimum replicas
  name: WORKER_PRIORITY_PENALTY_REPLICAS
  required: true
  value: "2"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_PRIORITY_PENALTY
  required: true
  value: 400Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_PRIORITY_PENALTY
  required: true
  value: 750Mi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_PRIORITY_PENALTY
  required: true
  value: 150m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_PRIORITY_PENALTY
  required: true
  value: 300m
- displayName: Worker Queue
  name: WORKER_PRIORITY_PENALTY_WORKER_QUEUE
  required: true
  value: priority_penalty
- displayName: Minimum replicas
  name: WORKER_REFRESH_REPLICAS
  required: true
  value: "2"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_REFRESH
  required: true
  value: 256Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_REFRESH
  required: true
  value: 512Mi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_REFRESH
  required: true
  value: 100m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_REFRESH
  required: true
  value: 200m
- displayName: Worker Queue
  name: WORKER_REFRESH_WORKER_QUEUE
  required: true
  value: refresh
- displayName: Minimum replicas
  name: WORKER_REFRESH_XL_REPLICAS
  required: true
  value: "2"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_REFRESH_XL
  required: true
  value: 256Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_REFRESH_XL
  required: true
  value: 512Mi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_REFRESH_XL
  required: true
  value: 100m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_REFRESH_XL
  required: true
  value: 200m
- displayName: Worker Queue
  name: WORKER_REFRESH_XL_WORKER_QUEUE
  required: true
  value: refresh_xl
- displayName: Minimum replicas
  name: WORKER_REFRESH_PENALTY_REPLICAS
  required: true
  value: "2"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_REFRESH_PENALTY
  required: true
  value: 256Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_REFRESH_PENALTY
  required: true
  value: 512Mi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_REFRESH_PENALTY
  required: true
  value: 100m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_REFRESH_PENALTY
  required: true
  value: 200m
- displayName: Worker Queue
  name: WORKER_REFRESH_PENALTY_WORKER_QUEUE
  required: true
  value: refresh_penalty
- displayName: Minimum replicas
  name: WORKER_SUMMARY_REPLICAS
  required: true
  value: "2"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_SUMMARY
  required: true
  value: 500Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_SUMMARY
  required: true
  value: 750Mi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_SUMMARY
  required: true
  value: 100m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_SUMMARY
  required: true
  value: 200m
- displayName: Worker Queue
  name: WORKER_SUMMARY_WORKER_QUEUE
  required: true
  value: summary
- displayName: Minimum replicas
  name: WORKER_SUMMARY_XL_REPLICAS
  required: true
  value: "2"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_SUMMARY_XL
  required: true
  value: 500Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_SUMMARY_XL
  required: true
  value: 750Mi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_SUMMARY_XL
  required: true
  value: 100m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_SUMMARY_XL
  required: true
  value: 200m
- displayName: Worker Queue
  name: WORKER_SUMMARY_XL_WORKER_QUEUE
  required: true
  value: summary_xl
- displayName: Minimum replicas
  name: WORKER_SUMMARY_PENALTY_REPLICAS
  required: true
  value: "2"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_SUMMARY_PENALTY
  required: true
  value: 500Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_SUMMARY_PENALTY
  required: true
  value: 750Mi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_SUMMARY_PENALTY
  required: true
  value: 100m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_SUMMARY_PENALTY
  required: true
  value: 200m
- displayName: Worker Queue
  name: WORKER_SUMMARY_PENALTY_WORKER_QUEUE
  required: true
  value: summary_penalty
- displayName: Minimum replicas
  name: WORKER_HCS_REPLICAS
  required: true
  value: "1"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_HCS
  required: true
  value: 300Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_HCS
  required: true
  value: 500Mi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_HCS
  required: true
  value: 100m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_HCS
  required: true
  value: 200m
- displayName: Worker Queue
  name: WORKER_HCS_WORKER_QUEUE
  required: true
  value: hcs
- displayName: HCS debug
  name: ENABLE_HCS_DEBUG
  value: "False"
- displayName: Minimum replicas
  name: WORKER_SUBS_EXTRACTION_REPLICAS
  required: true
  value: "0"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_SUBS_EXTRACTION
  required: true
  value: 300Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_SUBS_EXTRACTION
  required: true
  value: 500Mi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_SUBS_EXTRACTION
  required: true
  value: 100m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_SUBS_EXTRACTION
  required: true
  value: 200m
- displayName: Worker Queue
  name: WORKER_SUBS_EXTRACTION_WORKER_QUEUE
  required: true
  value: subs_extraction
- displayName: Minimum replicas
  name: WORKER_SUBS_TRANSMISSION_REPLICAS
  required: true
  value: "0"
- displayName: Memory Request
  name: MEMORY_REQUEST_WORKER_SUBS_TRANSMISSION
  required: true
  value: 300Mi
- displayName: Memory Limit
  name: MEMORY_LIMIT_WORKER_SUBS_TRANSMISSION
  required: true
  value: 500Mi
- displayName: CPU Request
  name: CPU_REQUEST_WORKER_SUBS_TRANSMISSION
  required: true
  value: 100m
- displayName: CPU Limit
  name: CPU_LIMIT_WORKER_SUBS_TRANSMISSION
  required: true
  value: 200m
- displayName: Worker Queue
  name: WORKER_SUBS_TRANSMISSION_WORKER_QUEUE
  required: true
  value: subs_transmission
